<ng-container *ngIf="shoppingCart.length > 0; else noContent">
	<div class="row mx-md-2" *ngIf="company.homeDelivery">
		<ng-container *ngTemplateOutlet="options"></ng-container>
	</div>
	<div class="row my-3 mx-md-2">
		<table class="table table-striped table-bordered table-condensed">
			<thead>
				<tr>
					<th>Nombre</th>
					<th>Precio</th>
					<th>Cantidad</th>
					<th>Mensaje</th>
					<th>Acciones</th>
				</tr>
			</thead>
			<tfoot *ngIf="shoppingCart.length >= 10">
				<tr>
					<th>Nombre</th>
					<th>Precio</th>
					<th>Cantidad</th>
					<th>Mensaje</th>
					<th>Acciones</th>
				</tr>
			</tfoot>
			<tbody>
				<tr *ngFor="let productInCart of shoppingCart; let i = index">
					<td>{{ productInCart.product.name }}</td>
					<td>{{ productInCart.total | number }}</td>
					<td>
						<input
							[tabindex]="i + 1"
							type="number"
							class="form-control"
							[(ngModel)]="productInCart.amount"
							(keydown.enter)="actualizePrice()"
							(focusout)="actualizePrice()"
						/>
					</td>
					<td>
						<textarea
							name="message"
							class="form-control"
							rows="2"
							[(ngModel)]="productInCart.message"
						></textarea>
					</td>
					<td class="text-center">
						<button class="btn btn-danger text-center" (click)="deleteProduct(i)">
							<i class="far fa-minus-square" title="Quitar producto del carrito"></i>
						</button>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
	<div class="row mx-md-2">
		<div class="col-sm-12 col-md-6 p-0">
			<h4 class="text-dark">
				Total: <span class="strong text-muted">{{ total | number }}</span>
			</h4>
		</div>
		<div class="col-sm-12 col-md-6 p-0 text-right">
			<button class="btn btn-info btn-sm-block mr-md-2" (click)="refreshPageEvent()">
				Cancelar
			</button>
			<button
				class="btn btn-success btn-sm-block"
				[disabled]="client.name.length <= 0 || shoppingCart.length == 0"
				(click)="finishOrder()"
				data-toggle="modal"
				data-target="#modalBills"
			>
				<i class="far fa-file" title="Registro"></i> Terminar Pedido
			</button>
		</div>
	</div>
</ng-container>
<ng-template #options>
	<div class="col-12 col-md-6 mb-2">
		<div class="input-group">
			<div class="input-group-prepend">
				<div class="input-group-text">
					<input
						type="checkbox"
						[(ngModel)]="doHomeDelivery"
						(change)="homeDeliveryChange()"
					/>
				</div>
			</div>
			<input
				min="0"
				step="1000"
				type="number"
				class="form-control"
				[placeholder]="!doHomeDelivery ? 'Domicilio' : 'Precio Del Domicilo'"
				[readonly]="!doHomeDelivery"
				[(ngModel)]="homeDelivery"
				(input)="actualizePrice()"
			/>
		</div>
	</div>
	<div class="col-12 col-md-6 mb-2">
		<div class="form-group">
			<input
				min="0"
				step="1000"
				type="number"
				class="form-control"
				id="cash"
				[(ngModel)]="cash"
				placeholder="Efectivo"
			/>
		</div>
	</div>
</ng-template>
<ng-template #noContent> Aun no tienes ningun producto seleccionado. </ng-template>
<app-modal idModal="modalBills" title="Pedido Finalizado">
	<div class="modal-body">
		<app-bill-view id="bill"></app-bill-view>
	</div>
	<div class="modal-footer">
		<button class="btn btn-info text-center" data-dismiss="modal" (click)="refreshPageEvent()">
			Salir
		</button>
		<app-print-pdf elementId="bill" [client]="client"></app-print-pdf>
	</div>
</app-modal>
